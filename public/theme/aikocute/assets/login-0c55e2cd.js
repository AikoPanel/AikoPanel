import{ba as b,bb as D,k as q,aa as E,j as e,F as M,a_ as x,l as y,B as v,o,aK as r,ai as m,bc as S,ao as t,bd as k,be as h,bf as R,bg as K,bh as O,T as g,aH as z,m as A,bi as G,ap as H}from"./vendor-894d6afa.js";import{A as V}from"./AuthWrapper-a2b9dc7c.js";import{F as $,c as N,a as I}from"./formik.esm-4935cab4.js";import{u as U,a as J,I as Q,b as X}from"./index-33033ac6.js";import{A as Y}from"./AnimateButton-c09ecc76.js";import"./hey-listen.es-3d38fef0.js";const Z=()=>{const[w,p]=b.useState(!1),{isLoggedIn:B}=U(a=>a.auth),[C]=J(),L=D(),{t:n}=q("common",{keyPrefix:"login"}),[u,_]=b.useState(!1),F=()=>{_(!u)},P=a=>{a.preventDefault()},T=a=>{a.getModifierState("CapsLock")?p(!0):p(!1)},W=E();return e(M,{children:e($,{initialValues:{email:"",password:"",submit:null},validationSchema:N().shape({email:I().email(n("email_invalid").toString()).max(255).required(n("email_required").toString()),password:I().max(255).required(n("password_required").toString())}),onSubmit:async(a,{setErrors:l,setStatus:s,setSubmitting:c})=>{try{c(!0),await C(a).unwrap().then(()=>{s({success:!0}),x.event("login",{category:"auth",label:"login",method:"email",success:!0,email:a.email}),W("/dashboard",{replace:!0})}).catch(i=>{s({success:!1}),l(y.isEmpty(i.errors)?{submit:i.message}:i.errors),x.event("login",{category:"auth",label:"login",method:"email",success:!1,error:i.message,email:a.email,values:a})}).finally(()=>{c(!1)})}catch(i){console.error(i),L.current&&(s({success:!1}),l(y.isEmpty(i.errors)?{submit:i.message}:i.errors),c(!1))}},children:({errors:a,handleBlur:l,handleChange:s,handleSubmit:c,isSubmitting:i,touched:d,values:f})=>e(v,{component:"form",noValidate:!0,onSubmit:c,children:o(r,{container:!0,spacing:3,children:[e(r,{item:!0,xs:12,children:o(m,{spacing:1,children:[e(S,{htmlFor:"email-login",children:e(t,{children:"login.email"})}),e(k,{id:"email-login",type:"email",value:f.email,name:"email",onBlur:l,onChange:s,placeholder:n("email_placeholder").toString(),fullWidth:!0,error:Boolean(d.email&&a.email)}),d.email&&a.email&&e(h,{error:!0,id:"standard-weight-helper-text-email-login",children:a.email})]})}),e(r,{item:!0,xs:12,children:o(m,{spacing:1,children:[e(S,{htmlFor:"password-login",children:e(t,{children:"login.password"})}),e(k,{fullWidth:!0,color:w?"warning":"primary",error:Boolean(d.password&&a.password),id:"-password-login",type:u?"text":"password",value:f.password,name:"password",onBlur:j=>{p(!1),l(j)},onKeyDown:T,onChange:s,endAdornment:e(R,{position:"end",children:e(Q,{"aria-label":"toggle password visibility",onClick:F,onMouseDown:P,edge:"end",color:"secondary",children:u?e(K,{}):e(O,{})})}),placeholder:n("password_placeholder").toString()}),w&&e(g,{variant:"caption",sx:{color:"warning.main"},id:"warning-helper-text-password-login",children:e(t,{ns:"notice",children:"capslock_on"})}),d.password&&a.password&&e(h,{error:!0,id:"standard-weight-helper-text-password-login",children:a.password})]})}),e(r,{item:!0,xs:12,sx:{mt:-1},children:o(m,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[e(v,{}),e(z,{variant:"h6",component:A,to:B?"/auth/forgot-password":"/forgot-password",color:"text.primary",children:n("forgot_password").toString()})]})}),a.submit&&e(r,{item:!0,xs:12,children:e(h,{error:!0,children:a.submit})}),e(r,{item:!0,xs:12,children:e(Y,{children:e(G,{disableElevation:!0,disabled:i,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:i?e(H,{size:24}):e(t,{i18nKey:"login.submit",children:"Submit"})})})})]})})})})},oe=()=>(X("login"),e(V,{children:o(r,{container:!0,spacing:3,children:[e(r,{item:!0,xs:12,children:o(m,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:{xs:-.5,sm:.5}},children:[e(g,{variant:"h3",children:e(t,{children:"login.title"})}),e(g,{component:A,to:"/register",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:e(t,{children:"login.go-register"})})]})}),e(r,{item:!0,xs:12,children:e(Z,{})})]})}));export{oe as default};
