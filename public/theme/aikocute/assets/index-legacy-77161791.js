System.register(["./vendor-legacy-a194f484.js","./KeyValueTable-legacy-09576c07.js","./index-legacy-3a6f8cc6.js","./formik.esm-legacy-a3c75cf9.js","./LoadingButton-legacy-c673a294.js","./Masonry-legacy-cada8f60.js"],(function(e,r){"use strict";var a,n,t,i,o,l,c,s,d,p,u,m,f,b,h,_,w,g,y,x,v,k,S,C,M,B,j,L,V,W,q,D,Y,T,E,H,K,N,O,z,P,R,A,F,U,$,I,J,Q;return{setters:[e=>{a=e.k,n=e.r,t=e.as,i=e.j,o=e.T,l=e.B,c=e.o,s=e.ai,d=e.cA,p=e.bi,u=e.ap,m=e.a9,f=e.bt,b=e.cC,h=e.ak,_=e.F,w=e.bP,g=e.bz,y=e.bA,x=e.bB,v=e.cN,k=e.cO,S=e.ao,C=e.aI,M=e.cS,B=e.cT,j=e.cU,L=e.cV,V=e.cW,W=e.aH},e=>{q=e.K},e=>{D=e.j,Y=e.M,T=e.J,E=e.P,H=e.Q,K=e.R,N=e.T,O=e.U,z=e.E,P=e.i,R=e.b},e=>{A=e.c,F=e.a,U=e.b,$=e.F,I=e.e},e=>{J=e.L},e=>{Q=e.M}],execute:function(){const r=()=>{const{t:e}=a(),{data:r,isLoading:l}=D(),c=n.useMemo((()=>[{key:e("profile.account-info-card.table.email",{context:"key"}),value:e("profile.account-info-card.table.email",{context:"value",email:r?.email})},{key:e("profile.account-info-card.table.sni",{context:"key"}),value:e("profile.account-info-card.table.sni",{context:"value",sni:r?.sni})},{key:e("profile.account-info-card.table.plan_expired_at",{context:"key"}),value:e("profile.account-info-card.table.plan_expired_at",{context:"value",date:t.unix(r?.expired_at??0).format("DD-MM-YYYY HH:mm")})},{key:e("profile.account-info-card.table.created_at",{context:"key"}),value:e("profile.account-info-card.table.created_at",{context:"value",date:t.unix(r?.created_at??0).format("DD-MM-YYYY HH:mm")})},{key:e("profile.account-info-card.table.days_existed",{context:"key"}),value:e("profile.account-info-card.table.days_existed",{context:"value",date:r?Math.floor((Date.now()-1e3*r.created_at)/864e5):"-"})}].map((e=>({key:i(o,{noWrap:!0,children:e.key}),value:i(o,{noWrap:!0,children:e.value})})))),[r,e]);return i(Y,{title:e("profile.account-info-card.title"),children:i(q,{data:c,isValueLoading:l})})},G={old_password:"",new_password:"",confirm_password:"",submit:null},X=()=>{const{t:e}=a(),r=T(),[t]=E(),m=n.useMemo((()=>A({old_password:F().required(e("profile.change-password-card.form.old_password",{context:"required"}).toString()),new_password:F().required(e("profile.change-password-card.form.new_password",{context:"required"}).toString()).min(8,e("profile.change-password-card.form.new_password",{context:"min",count:8}).toString()),confirm_password:F().required(e("profile.change-password-card.form.confirm_password",{context:"required"}).toString()).oneOf([U("new_password")],e("profile.change-password-card.form.confirm_password",{context:"not_match"}).toString())})),[e]),f=n.useCallback((async(e,{setSubmitting:a,setStatus:n,setErrors:i})=>{try{await t(e).unwrap(),n({success:!0}),r(H())}catch(o){const e=o;console.error("Error changing password",e),n({success:!1,message:e.message}),i(e.errors||{submit:e.message})}finally{a(!1)}}),[t,r]);return i(Y,{title:e("profile.change-password-card.title"),children:i($,{initialValues:G,validationSchema:m,onSubmit:f,children:({handleChange:r,handleBlur:a,handleSubmit:n,errors:t,touched:m,isSubmitting:f,values:b})=>i(l,{component:"form",onSubmit:n,children:c(s,{spacing:2,children:[i(d,{type:"password",id:"old_password-label",name:"old_password",label:e("profile.change-password-card.form.old_password",{context:"label"}),value:b.old_password,onChange:r,onBlur:a,error:Boolean(m.old_password&&t.old_password),helperText:m.old_password&&t.old_password,disabled:f,fullWidth:!0}),i(d,{type:"password",id:"new_password-label",name:"new_password",label:e("profile.change-password-card.form.new_password",{context:"label"}),value:b.new_password,onChange:r,onBlur:a,error:Boolean(m.new_password&&t.new_password),helperText:m.new_password&&t.new_password,disabled:f,autoComplete:"new-password",fullWidth:!0}),i(d,{type:"password",id:"confirm_password-label",name:"confirm_password",label:e("profile.change-password-card.form.confirm_password",{context:"label"}),value:b.confirm_password,onChange:r,onBlur:a,error:Boolean(m.confirm_password&&t.confirm_password),helperText:m.confirm_password&&t.confirm_password,disabled:f,autoComplete:"new-password",fullWidth:!0}),c(s,{direction:"row",justifyContent:"space-between",children:[i(l,{children:i(o,{variant:"caption",color:"error",noWrap:!0,children:t.submit})}),i(s,{direction:"row",justifyContent:"flex-end",spacing:2,children:i(p,{type:"submit",variant:"contained",disabled:f,children:f?i(u,{size:16}):e("profile.change-password-card.form.submit-button")})})]})]})})})})},Z=()=>{const{t:e}=a(),{data:r,isLoading:t}=D(),[o]=K(),{enqueueSnackbar:d}=m(),p=n.useMemo((()=>({remind_expire:1===r?.remind_expire,remind_traffic:1===r?.remind_traffic})),[r]),u=n.useCallback((async(r,{setSubmitting:a,setStatus:n,setErrors:t})=>{try{await o({remind_expire:r.remind_expire?1:0,remind_traffic:r.remind_traffic?1:0}).unwrap(),n({success:!0}),d(e("notice::success.update"),{variant:"success"})}catch(i){n({success:!1}),t(i.errors||{submit:i.message})}finally{a(!1)}}),[d,e]);return i(Y,{title:e("profile.notification-card.title"),children:i($,{initialValues:p,onSubmit:u,enableReinitialize:!0,children:({values:r,handleChange:a,handleSubmit:n,handleBlur:o,isSubmitting:d})=>i(l,{component:I,onSubmit:n,children:c(s,{spacing:2,children:[i(f,{control:i(b,{}),name:"remind_expire",checked:r.remind_expire,disabled:t||d,onChange:a,onBlur:o,label:e("profile.notification-card.expired_notify",{context:"label"}),labelPlacement:"end",sx:{m:0}}),i(f,{control:i(b,{}),name:"remind_traffic",checked:r.remind_traffic,disabled:t||d,onChange:a,onBlur:o,label:e("profile.notification-card.traffic_notify",{context:"label"}),labelPlacement:"end",sx:{m:0}}),i(s,{direction:"row",justifyContent:"flex-end",children:i(J,{variant:"contained",type:"submit",loading:t||d,children:e("profile.notification-card.save-button")})})]})})})})},ee=()=>{const{t:e}=a(),[r,{setLeft:t,setRight:o}]=h(!1),{enqueueSnackbar:l}=m(),[d,{isLoading:u}]=N(),f=n.useCallback((async()=>{try{await d().unwrap(),l(e("notice::reset-security",{context:"success"}),{variant:"success"})}catch(r){console.error(r),l(e("notice::reset-security",{context:"failed"}),{variant:"error"})}finally{t()}}),[d,l,e,t]);return c(_,{children:[i(Y,{title:e("profile.reset-subscription-card.title"),children:c(s,{spacing:2,children:[i(w,{severity:"warning",children:e("profile.reset-subscription-card.alert")}),i(p,{variant:"contained",color:"error",fullWidth:!0,onClick:o,children:e("profile.reset-subscription-card.button")})]})}),c(g,{open:r,onClose:t,"aria-labelledby":"form-dialog-title",children:[i(y,{id:"form-dialog-title",children:e("profile.reset-subscription-card.dialog.title")}),i(x,{children:i(v,{children:e("profile.reset-subscription-card.dialog.content")})}),c(k,{children:[i(p,{onClick:t,color:"primary",children:e("profile.reset-subscription-card.dialog.cancel")}),i(J,{onClick:f,color:"error",loading:u,children:e("profile.reset-subscription-card.dialog.confirm")})]})]})]})},re=()=>{const{t:e}=a(),{data:r}=O(),{data:t}=z(),{data:d}=P(),u=n.useMemo((()=>S),[e]),[m,f]=C("telegram_card_init",{defaultValue:0}),[b,{inc:h,dec:_}]=M(m,{min:0,max:2});n.useEffect((()=>{f(b)}),[b]);const w=n.useMemo((()=>()=>c(s,{direction:"row",spacing:1,mt:2,children:[i(p,{onClick:()=>h(),variant:"contained",disabled:b>=2,children:e("profile.telegram-card.next_step")}),i(p,{onClick:()=>_(),variant:"text",disabled:b<=0,children:e("profile.telegram-card.previous_step")})]})),[e,b]);return i(Y,{title:e("profile.telegram-card.title"),children:r?.username||t?.is_telegram?c(B,{activeStep:b,orientation:"vertical",children:[c(j,{children:[i(L,{children:i(o,{variant:"subtitle1",children:e("profile.telegram-card.add_bot",{context:"label"})})}),c(V,{children:[i(l,{children:i(u,{i18nKey:"profile.telegram-card.add_bot",tOptions:{context:"content",name:r?.username},children:i(W,{href:`https://t.me/${r?.username}`,target:"_blank"})})}),i(w,{})]})]}),c(j,{children:[i(L,{children:i(o,{variant:"subtitle1",children:e("profile.telegram-card.send_command",{context:"label"})})}),c(V,{children:[i(l,{children:i(u,{i18nKey:"profile.telegram-card.send_command",tOptions:{context:"content"},children:{command:`/bind ${d?.subscribe_url}`}})}),i(w,{})]})]}),c(j,{children:[i(L,{children:i(o,{variant:"subtitle1",children:e("profile.telegram-card.add_to_group",{context:"label"})})}),c(V,{children:[i(l,{children:i(o,{children:i(u,{i18nKey:"profile.telegram-card.add_to_group",tOptions:{link:t?.telegram_discuss_link,context:"content"},children:i(W,{href:t?.telegram_discuss_link,target:"_blank",rel:"noreferrer"})})})}),i(w,{})]})]})]}):i(o,{children:e("profile.telegram-card.not_configured")})})},ae=()=>{const{t:e}=a(),{data:r,isLoading:t}=D(),l=n.useMemo((()=>[{key:e("profile.wallet-card.table.balance",{context:"key"}),value:e("profile.wallet-card.table.balance",{context:"value",value:((r?.balance??0)/100).toLocaleString("vi-VN",{style:"currency",currency:"VND"}),count:(r?.balance??0)/100})},{key:e("profile.wallet-card.table.commission_balance",{context:"key"}),value:e("profile.wallet-card.table.commission_balance",{context:"value",value:((r?.commission_balance??0)/100).toLocaleString("vi-VN",{style:"currency",currency:"VND"}),count:(r?.commission_balance??0)/100})}].map((e=>({key:i(o,{noWrap:!0,children:e.key}),value:i(o,{noWrap:!0,children:e.value})})))),[r,e]);return i(Y,{title:e("profile.wallet-card.title"),children:i(q,{data:l,isValueLoading:t})})},ne=()=>c(Q,{spacing:2,columns:{xs:1,md:2,xl:3},children:[i(r,{}),i(ae,{}),i(X,{}),i(Z,{}),i(re,{}),i(ee,{})]});e("default",(()=>(R("profile"),i(ne,{}))))}}}));
