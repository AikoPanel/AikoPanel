System.register(["./vendor-legacy-a194f484.js","./AuthWrapper-legacy-8f02bdff.js","./formik.esm-legacy-a3c75cf9.js","./password-strength-legacy-b0b499a5.js","./AnimateButton-legacy-300e3bb6.js","./index-legacy-3a6f8cc6.js","./hey-listen.es-legacy-2cf185e9.js"],(function(e,r){"use strict";var o,i,s,a,t,n,l,d,c,m,p,u,h,g,w,_,f,b,x,y,S,v,C,B,j,q,k,F,A,W,E,I,K,P,z,D,V,O,R;return{setters:[e=>{o=e.i,i=e.k,s=e.bb,a=e.aa,t=e.a9,n=e.r,l=e.j,d=e.F,c=e.a_,m=e.o,p=e.aK,u=e.ai,h=e.bc,g=e.ao,w=e.bd,_=e.be,f=e.bf,b=e.bg,x=e.bh,y=e.bs,S=e.B,v=e.T,C=e.l,B=e.bi,j=e.ap,q=e.m},e=>{k=e.A},e=>{F=e.F,A=e.c,W=e.a,E=e.b},e=>{I=e.S,K=e.O,P=e.s,z=e.a},e=>{D=e.A},e=>{V=e.g,O=e.I,R=e.b},null],execute:function(){const r=()=>{const e=o(),{t:r}=i("common"),q=s(),k=a(),{enqueueSnackbar:R}=t(),[$]=V(),[M,T]=n.useState(),[G,H]=n.useState(!1),J=()=>{H(!G)},L=e=>{e.preventDefault()},N=e=>{const r=P(e);T(z(r))};return n.useEffect((()=>{N("")}),[]),l(d,{children:l(F,{initialValues:{email:"",password:"",password_confirm:"",email_code:"",submit:null},validationSchema:A().shape({email:W().email(r("forgot_password.email_invalid").toString()).max(255,r("forgot_password.email_max",{count:255}).toString()).required(r("forgot_password.email_required").toString()),password:W().max(255,r("forgot_password.password_max",{count:255}).toString()).required(r("forgot_password.password_required").toString()),password_confirm:W().oneOf([E("password"),null],r("forgot_password.password_confirm_invalid").toString()).required(r("forgot_password.password_confirm_required").toString()),email_code:W().min(6,r("forgot_password.email_code_min",{count:6}).toString()).max(6,r("forgot_password.email_code_max",{count:6}).toString()).required(r("forgot_password.email_code_required").toString())}),onSubmit:async(e,{setErrors:o,setStatus:i,setSubmitting:s})=>{if(6!==e.email_code.length)return i({success:!1}),void o({email_code:r("forgot_password.email_code_invalid").toString()});await $({email:e.email,password:e.password,email_code:e.email_code}).unwrap().then((()=>{q.current&&(i({success:!0}),s(!1),R(r("notice::forgot_password.reset_success"),{variant:"success"}),c.event("reset_password",{category:"auth",label:"reset_password",email:e.email,success:!0}),k("/login",{replace:!0}))})).catch((r=>{console.error("Error in reset password",r),q.current&&(i({success:!1}),o(r.errors||{submit:r.message}),s(!1),c.event("reset_password",{category:"auth",label:"reset_password",email:e.email,success:!1,error:r.message}))})).finally((()=>{q.current&&s(!1)}))},children:({errors:o,handleBlur:i,handleChange:s,handleSubmit:a,isSubmitting:t,touched:n,values:d,setValues:c})=>l("form",{noValidate:!0,onSubmit:a,children:m(p,{container:!0,spacing:3,children:[l(p,{item:!0,xs:12,children:m(u,{spacing:1,children:[l(h,{htmlFor:"email",children:l(g,{children:"forgot_password.email"})}),l(w,{fullWidth:!0,error:Boolean(n.email&&o.email),id:"email",type:"email",value:d.email,name:"email",onBlur:i,onChange:s,placeholder:"user@example.com",inputProps:{},endAdornment:l(I,{email:d.email})}),n.email&&o.email&&l(_,{error:!0,id:"helper-text-email-signup",children:o.email})]})}),l(p,{item:!0,xs:12,children:m(u,{spacing:1,children:[l(h,{htmlFor:"email-code-signup",children:l(g,{children:"forgot_password.email_code"})}),l(K,{value:d.email_code,onChange:e=>{c((r=>({...r,email_code:e})))},numInputs:6,containerStyle:{justifyContent:"space-between"},inputProps:{name:"email_code",id:"email-code-signup",onBlur:i},inputStyle:{width:"100%",margin:"8px",padding:"10px",border:`1px solid ${"dark"===e.palette.mode?e.palette.grey[200]:e.palette.grey[300]}`,borderRadius:4,":hover":{borderColor:e.palette.primary.main}},focusStyle:{outline:"none",boxShadow:e.customShadows.primary,border:`1px solid ${e.palette.primary.main}`}}),n.email_code&&o.email_code&&l(_,{error:!0,id:"helper-text-email-signup",children:o.email_code})]})}),m(p,{item:!0,xs:12,children:[m(u,{spacing:1,children:[l(h,{htmlFor:"password-signup",children:l(g,{children:"forgot_password.password"})}),l(w,{fullWidth:!0,error:Boolean(n.password&&o.password),id:"password-signup",type:G?"text":"password",value:d.password,name:"password",onBlur:i,onChange:e=>{s(e),N(e.target.value)},autoComplete:"new-password",endAdornment:l(f,{position:"end",children:l(O,{"aria-label":"toggle password visibility",onClick:J,onMouseDown:L,edge:"end",color:"secondary",children:l(G?b:x,{})})}),placeholder:"******",inputProps:{}}),n.password&&o.password&&l(_,{error:!0,id:"helper-text-password-signup",children:o.password})]}),l(y,{fullWidth:!0,sx:{mt:2},children:m(p,{container:!0,spacing:2,alignItems:"center",children:[l(p,{item:!0,children:l(S,{sx:{bgcolor:M?.color,width:85,height:8,borderRadius:"7px"}})}),l(p,{item:!0,children:l(v,{variant:"subtitle1",fontSize:"0.75rem",children:r("forgot_password.password_strength",{context:C.lowerCase(M?.label)}).toString()})})]})})]}),l(p,{item:!0,xs:12,children:m(u,{spacing:1,children:[l(h,{htmlFor:"password-confirm",children:l(g,{children:"forgot_password.password_confirm"})}),l(w,{fullWidth:!0,error:Boolean(n.password_confirm&&o.password_confirm),id:"password-confirm",type:G?"text":"password",value:d.password_confirm,name:"password_confirm",onBlur:i,onChange:e=>{s(e),N(e.target.value)},autoComplete:"new-password",placeholder:"******",inputProps:{}}),n.password_confirm&&o.password_confirm&&l(_,{error:!0,id:"helper-text-password-confirm",children:o.password_confirm})]})}),o.submit&&l(p,{item:!0,xs:12,children:l(_,{error:!0,children:o.submit})}),l(p,{item:!0,xs:12,children:l(D,{children:l(B,{disableElevation:!0,disabled:t,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:t?l(j,{size:24}):l(g,{i18nKey:"forgot_password.submit",children:"重置密码"})})})})]})})})})};e("default",(()=>(R("forgot-password"),l(k,{children:m(p,{container:!0,spacing:3,children:[l(p,{item:!0,xs:12,children:m(u,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:{xs:-.5,sm:.5}},children:[l(v,{variant:"h3",children:l(g,{i18nKey:"forgot_password.title",children:"Forgot password"})}),l(v,{component:q,to:"/login",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:l(g,{i18nKey:"forgot_password.back_to_login",children:"Back to login"})})]})}),l(p,{item:!0,xs:12,children:l(r,{})})]})}))))}}}));
