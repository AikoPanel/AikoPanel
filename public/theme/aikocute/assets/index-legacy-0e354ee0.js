System.register(["./vendor-legacy-21e846b5.js","./DataGrid-legacy-78dcbc66.js","./index-legacy-4d5357df.js","./KeyValueTable-legacy-e5a54083.js"],(function(e,t){"use strict";var r,a,o,n,i,d,s,l,c,u,f,m,g,p,h,v,y,b;return{setters:[e=>{r=e.k,a=e.j,o=e.bK,n=e.i,i=e.a4,d=e.bb,s=e.r,l=e.at,c=e.cp,u=e.l,f=e.cq,m=e.o,g=e.aL},e=>{p=e.D},e=>{h=e.$,v=e.M,y=e.b},e=>{b=e.K}],execute:function(){const t=()=>{const{t:e}=r();return a(o,{severity:"info",children:e("traffic.alert")})},x=()=>{const{t:e}=r(),t=n(),o=i(t.breakpoints.down("md")),{data:u,isLoading:f}=h(),[m,g]=d.useState(10),y=s.useMemo((()=>[{field:"record_at",headerName:e("traffic.table.record_at",{context:"header"}).toString(),description:e("traffic.table.record_at",{context:"description"}).toString(),width:200,type:"dateTime",valueGetter:e=>l.unix(e.value).toDate(),valueFormatter:e=>l(e.value).format("DD-MM-YYYY HH:mm")},{field:"u",headerName:e("traffic.table.upload",{context:"header"}).toString(),description:e("traffic.table.upload",{context:"description"}).toString(),width:120,type:"number",valueGetter:e=>e.value/(isNaN(parseInt(e.row.server_rate))?1:parseInt(e.row.server_rate)),valueFormatter:e=>c(e.value,{base:2,standard:"jedec",round:2,roundingMethod:"floor"})},{field:"d",headerName:e("traffic.table.download",{context:"header"}).toString(),description:e("traffic.table.download",{context:"description"}).toString(),width:120,type:"number",valueGetter:e=>e.value/(isNaN(parseInt(e.row.server_rate))?1:parseInt(e.row.server_rate)),valueFormatter:e=>c(e.value,{base:2,standard:"jedec",round:2,roundingMethod:"floor"})},{field:"server_rate",headerName:e("traffic.table.server_rate",{context:"header"}).toString(),description:e("traffic.table.server_rate",{context:"description"}).toString(),width:120,type:"number",valueGetter:e=>parseInt(e.value)||1,valueFormatter:e=>`${e.value.toFixed(2)} x`},{field:"total",headerName:e("traffic.table.total",{context:"header"}).toString(),description:e("traffic.table.total",{context:"description"}).toString(),width:160,type:"number",valueGetter:e=>e.row.u+e.row.d,valueFormatter:e=>c(e.value,{base:2,standard:"jedec",round:2,roundingMethod:"floor"})}]),[e,l,c]);return a(v,{content:!1,children:a(p,{columns:y,rows:u??[],loading:f,getRowId:e=>`${e.record_at}_${e.server_rate}`,rowsPerPageOptions:[5,10,25,50],pageSize:m,onPageSizeChange:e=>g(e),sx:{height:{md:400}},autoHeight:o})})},w=()=>{const{t:e}=r(),t=n(),{secondary:o}=t.palette.text,[i,d]=s.useState(7),{data:m}=h(),g=s.useMemo((()=>u.take(Array.from((m??[]).reduce(((e,t)=>e.set(t.record_at,{u:t.u/(isNaN(parseInt(t.server_rate))?1:parseInt(t.server_rate))+(e.get(t.record_at)?.u??0),d:t.d/(isNaN(parseInt(t.server_rate))?1:parseInt(t.server_rate))+(e.get(t.record_at)?.d??0),total:(t.u+t.d)/parseInt(t.server_rate)+(e.get(t.record_at)?.total??0)})),new Map).values()).reverse(),i)),[m,i]),p=s.useMemo((()=>[{name:e("traffic.chart.upload",{context:"name"}).toString(),data:g.map((e=>e.u))||Array(i).fill(0),color:t.palette.warning.main},{name:e("traffic.chart.download",{context:"name"}).toString(),data:g.map((e=>e.d))||Array(i).fill(0),color:t.palette.success.main},{name:e("traffic.chart.total",{context:"name"}).toString(),data:g.map((e=>e.total))||Array(i).fill(0),color:t.palette.primary.light}]),[m,i,t.palette,e]),y=s.useMemo((()=>({chart:{height:280,type:"area",toolbar:{show:!1}},fill:{type:"gradient",gradient:{shadeIntensity:1,type:"vertical",inverseColors:!1,opacityFrom:.5,opacityTo:0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{show:!0,strokeDashArray:0,position:"back",borderColor:t.palette.divider,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!0}}},xaxis:{categories:Array.from(new Array(i)).map(((e,t)=>l().subtract(t,"day").toISOString())).reverse(),labels:{formatter:e=>l(e).format("MM.DD"),style:{colors:Array.from(new Array(i)).map((()=>o))}},axisBorder:{show:!1,color:t.palette.divider},tickAmount:i,axisTicks:{show:!1}},yaxis:{labels:{formatter:e=>String(c(e,{base:2,standard:"jedec",round:2,roundingMethod:"floor"})),style:{colors:Array.from(new Array(i)).map((()=>o))}},axisBorder:{show:!1},axisTicks:{show:!1}},tooltip:{theme:t.palette.mode,x:{formatter:e=>l().subtract(i-e,"day").format("DD-MM-YYYY")},y:{formatter:e=>String(c(e,{base:2,standard:"jedec",round:2,roundingMethod:"floor"}))}},legend:{show:!1}})),[i,t.palette,e]);return a(v,{title:e("traffic.chart.title").toString(),divider:!1,children:a(f,{options:y,series:p,type:"area",height:280})})},S=()=>{const{t:e}=r(),{data:t,isLoading:o}=h(),n=s.useMemo((()=>[{key:e("traffic.info-card.sum_upload",{context:"label"}).toString(),value:String(c(t?.reduce(((e,t)=>e+t.u/(parseInt(t.server_rate)||1)),0)??0,{base:2,standard:"jedec",round:2,roundingMethod:"floor"}))},{key:e("traffic.info-card.sum_download",{context:"label"}).toString(),value:String(c(t?.reduce(((e,t)=>e+t.d/(parseInt(t.server_rate)||1)),0)??0,{base:2,standard:"jedec",round:2,roundingMethod:"floor"}))},{key:e("traffic.info-card.sum_total",{context:"label"}).toString(),value:String(c(t?.reduce(((e,t)=>e+(t.u+t.d)/(parseInt(t.server_rate)||1)),0)??0,{base:2,standard:"jedec",round:2,roundingMethod:"floor"}))},{key:e("traffic.info-card.day_num",{context:"label"}).toString(),value:new Map(t?.map((e=>[e.record_at,null]))).size.toString()},{key:e("traffic.info-card.average_total",{context:"label"}).toString(),value:String(c((t??[]).reduce(((e,t)=>e+(t.u+t.d)/(parseInt(t.server_rate)||1)),0)/Math.max((t??[]).length,1),{base:2,standard:"jedec",round:2,roundingMethod:"floor"}))}]),[e,c,t]);return a(v,{title:e("traffic.info-card.title").toString(),contentSX:{height:{xs:"auto",md:335}},children:a(b,{data:n,isValueLoading:o})})},_=()=>m(g,{container:!0,spacing:2,children:[a(g,{item:!0,xs:12,children:a(t,{})}),a(g,{item:!0,xs:12,md:8,children:a(w,{})}),a(g,{item:!0,xs:12,md:4,children:a(S,{})}),a(g,{item:!0,xs:12,children:a(x,{})})]});e("default",(()=>(y("traffic"),a(_,{}))))}}}));
