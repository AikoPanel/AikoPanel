import{bb as f,bc as q,k as D,ab as E,j as e,F as M,bd as R,be as O,bf as x,a$ as y,l as v,B as S,o as t,aL as r,aj as m,bg as k,ap as o,bh as I,bi as h,bj as $,bk as z,bl as G,T as g,aI as K,m as L,bm as V,aq as H}from"./vendor-4c8effbd.js";import{A as N}from"./AuthWrapper-6020a3ed.js";import{u as U,a as J,I as Q,b as X}from"./index-efdad191.js";import{A as Y}from"./AnimateButton-f68c7436.js";const Z=()=>{const[w,u]=f.useState(!1),{isLoggedIn:A}=U(a=>a.auth),[B]=J(),C=q(),{t:n}=D("common",{keyPrefix:"login"}),[p,j]=f.useState(!1),_=()=>{j(!p)},F=a=>{a.preventDefault()},P=a=>{a.getModifierState("CapsLock")?u(!0):u(!1)},T=E();return e(M,{children:e(R,{initialValues:{email:"",password:"",submit:null},validationSchema:O().shape({email:x().email(n("email_invalid").toString()).max(255).required(n("email_required").toString()),password:x().max(255).required(n("password_required").toString())}),onSubmit:async(a,{setErrors:l,setStatus:s,setSubmitting:c})=>{try{c(!0),await B(a).unwrap().then(()=>{s({success:!0}),y.event("login",{category:"auth",label:"login",method:"email",success:!0,email:a.email}),T("/dashboard",{replace:!0})}).catch(i=>{s({success:!1}),l(v.isEmpty(i.errors)?{submit:i.message}:i.errors),y.event("login",{category:"auth",label:"login",method:"email",success:!1,error:i.message,email:a.email,values:a})}).finally(()=>{c(!1)})}catch(i){console.error(i),C.current&&(s({success:!1}),l(v.isEmpty(i.errors)?{submit:i.message}:i.errors),c(!1))}},children:({errors:a,handleBlur:l,handleChange:s,handleSubmit:c,isSubmitting:i,touched:d,values:b})=>e(S,{component:"form",noValidate:!0,onSubmit:c,children:t(r,{container:!0,spacing:3,children:[e(r,{item:!0,xs:12,children:t(m,{spacing:1,children:[e(k,{htmlFor:"email-login",children:e(o,{children:"login.email"})}),e(I,{id:"email-login",type:"email",value:b.email,name:"email",onBlur:l,onChange:s,placeholder:n("email_placeholder").toString(),fullWidth:!0,error:Boolean(d.email&&a.email)}),d.email&&a.email&&e(h,{error:!0,id:"standard-weight-helper-text-email-login",children:a.email})]})}),e(r,{item:!0,xs:12,children:t(m,{spacing:1,children:[e(k,{htmlFor:"password-login",children:e(o,{children:"login.password"})}),e(I,{fullWidth:!0,color:w?"warning":"primary",error:Boolean(d.password&&a.password),id:"-password-login",type:p?"text":"password",value:b.password,name:"password",onBlur:W=>{u(!1),l(W)},onKeyDown:P,onChange:s,endAdornment:e($,{position:"end",children:e(Q,{"aria-label":"toggle password visibility",onClick:_,onMouseDown:F,edge:"end",color:"secondary",children:p?e(z,{}):e(G,{})})}),placeholder:n("password_placeholder").toString()}),w&&e(g,{variant:"caption",sx:{color:"warning.main"},id:"warning-helper-text-password-login",children:e(o,{ns:"notice",children:"capslock_on"})}),d.password&&a.password&&e(h,{error:!0,id:"standard-weight-helper-text-password-login",children:a.password})]})}),e(r,{item:!0,xs:12,sx:{mt:-1},children:t(m,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[e(S,{}),e(K,{variant:"h6",component:L,to:A?"/auth/forgot-password":"/forgot-password",color:"text.primary",children:n("forgot_password").toString()})]})}),a.submit&&e(r,{item:!0,xs:12,children:e(h,{error:!0,children:a.submit})}),e(r,{item:!0,xs:12,children:e(Y,{children:e(V,{disableElevation:!0,disabled:i,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:i?e(H,{size:24}):e(o,{i18nKey:"login.submit",children:"Submit"})})})})]})})})})},ne=()=>(X("login"),e(N,{children:t(r,{container:!0,spacing:3,children:[e(r,{item:!0,xs:12,children:t(m,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:{xs:-.5,sm:.5}},children:[e(g,{variant:"h3",children:e(o,{children:"login.title"})}),e(g,{component:L,to:"/register",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:e(o,{children:"login.go-register"})})]})}),e(r,{item:!0,xs:12,children:e(Z,{})})]})}));export{ne as default};
