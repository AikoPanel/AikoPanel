import{k as _,r as b,as as T,j as e,T as m,B as w,o as d,ai as h,cA as y,bi as x,ap as A,a9 as j,bt as L,cC as V,ak as B,F,bP as N,bz as O,bA as R,bB as G,cN as H,cO as K,ao as Q,aI as $,cS as E,cT as z,cU as k,cV as v,cW as C,aH as W}from"./vendor-894d6afa.js";import{K as q}from"./KeyValueTable-ee52097e.js";import{j as M,M as g,J as D,P as I,Q as J,R as X,T as Z,U as ee,E as re,i as ae,b as ne}from"./index-33033ac6.js";import{c as te,a as S,b as oe,F as U,e as ie}from"./formik.esm-4935cab4.js";import{L as Y}from"./LoadingButton-84bfc517.js";import{M as ce}from"./Masonry-a910b117.js";const se=()=>{const{t:r}=_(),{data:a,isLoading:n}=M(),u=b.useMemo(()=>{var c,s;return[{key:r("profile.account-info-card.table.email",{context:"key"}),value:r("profile.account-info-card.table.email",{context:"value",email:a==null?void 0:a.email})},{key:r("profile.account-info-card.table.sni",{context:"key"}),value:r("profile.account-info-card.table.sni",{context:"value",sni:a==null?void 0:a.sni})},{key:r("profile.account-info-card.table.plan_expired_at",{context:"key"}),value:r("profile.account-info-card.table.plan_expired_at",{context:"value",date:T.unix((c=a==null?void 0:a.expired_at)!=null?c:0).format("DD-MM-YYYY HH:mm")})},{key:r("profile.account-info-card.table.created_at",{context:"key"}),value:r("profile.account-info-card.table.created_at",{context:"value",date:T.unix((s=a==null?void 0:a.created_at)!=null?s:0).format("DD-MM-YYYY HH:mm")})},{key:r("profile.account-info-card.table.days_existed",{context:"key"}),value:r("profile.account-info-card.table.days_existed",{context:"value",date:a?Math.floor((Date.now()-a.created_at*1e3)/(1e3*60*60*24)):"-"})}].map(l=>({key:e(m,{noWrap:!0,children:l.key}),value:e(m,{noWrap:!0,children:l.value})}))},[a,r]);return e(g,{title:r("profile.account-info-card.title"),children:e(q,{data:u,isValueLoading:n})})},le={old_password:"",new_password:"",confirm_password:"",submit:null},de=()=>{const{t:r}=_(),a=D(),[n]=I(),u=b.useMemo(()=>te({old_password:S().required(r("profile.change-password-card.form.old_password",{context:"required"}).toString()),new_password:S().required(r("profile.change-password-card.form.new_password",{context:"required"}).toString()).min(8,r("profile.change-password-card.form.new_password",{context:"min",count:8}).toString()),confirm_password:S().required(r("profile.change-password-card.form.confirm_password",{context:"required"}).toString()).oneOf([oe("new_password")],r("profile.change-password-card.form.confirm_password",{context:"not_match"}).toString())}),[r]),c=b.useCallback(async(s,{setSubmitting:l,setStatus:t,setErrors:o})=>{try{await n(s).unwrap(),t({success:!0}),a(J())}catch(p){const i=p;console.error("Error changing password",i),t({success:!1,message:i.message}),o(i.errors||{submit:i.message})}finally{l(!1)}},[n,a]);return e(g,{title:r("profile.change-password-card.title"),children:e(U,{initialValues:le,validationSchema:u,onSubmit:c,children:({handleChange:s,handleBlur:l,handleSubmit:t,errors:o,touched:p,isSubmitting:i,values:f})=>e(w,{component:"form",onSubmit:t,children:d(h,{spacing:2,children:[e(y,{type:"password",id:"old_password-label",name:"old_password",label:r("profile.change-password-card.form.old_password",{context:"label"}),value:f.old_password,onChange:s,onBlur:l,error:Boolean(p.old_password&&o.old_password),helperText:p.old_password&&o.old_password,disabled:i,fullWidth:!0}),e(y,{type:"password",id:"new_password-label",name:"new_password",label:r("profile.change-password-card.form.new_password",{context:"label"}),value:f.new_password,onChange:s,onBlur:l,error:Boolean(p.new_password&&o.new_password),helperText:p.new_password&&o.new_password,disabled:i,autoComplete:"new-password",fullWidth:!0}),e(y,{type:"password",id:"confirm_password-label",name:"confirm_password",label:r("profile.change-password-card.form.confirm_password",{context:"label"}),value:f.confirm_password,onChange:s,onBlur:l,error:Boolean(p.confirm_password&&o.confirm_password),helperText:p.confirm_password&&o.confirm_password,disabled:i,autoComplete:"new-password",fullWidth:!0}),d(h,{direction:"row",justifyContent:"space-between",children:[e(w,{children:e(m,{variant:"caption",color:"error",noWrap:!0,children:o.submit})}),e(h,{direction:"row",justifyContent:"flex-end",spacing:2,children:e(x,{type:"submit",variant:"contained",disabled:i,children:i?e(A,{size:16}):r("profile.change-password-card.form.submit-button")})})]})]})})})})},pe=()=>{const{t:r}=_(),{data:a,isLoading:n}=M(),[u]=X(),{enqueueSnackbar:c}=j(),s=b.useMemo(()=>({remind_expire:(a==null?void 0:a.remind_expire)===1,remind_traffic:(a==null?void 0:a.remind_traffic)===1}),[a]),l=b.useCallback(async(t,{setSubmitting:o,setStatus:p,setErrors:i})=>{try{await u({remind_expire:t.remind_expire?1:0,remind_traffic:t.remind_traffic?1:0}).unwrap(),p({success:!0}),c(r("notice::success.update"),{variant:"success"})}catch(f){p({success:!1}),i(f.errors||{submit:f.message})}finally{o(!1)}},[c,r]);return e(g,{title:r("profile.notification-card.title"),children:e(U,{initialValues:s,onSubmit:l,enableReinitialize:!0,children:({values:t,handleChange:o,handleSubmit:p,handleBlur:i,isSubmitting:f})=>e(w,{component:ie,onSubmit:p,children:d(h,{spacing:2,children:[e(L,{control:e(V,{}),name:"remind_expire",checked:t.remind_expire,disabled:n||f,onChange:o,onBlur:i,label:r("profile.notification-card.expired_notify",{context:"label"}),labelPlacement:"end",sx:{m:0}}),e(L,{control:e(V,{}),name:"remind_traffic",checked:t.remind_traffic,disabled:n||f,onChange:o,onBlur:i,label:r("profile.notification-card.traffic_notify",{context:"label"}),labelPlacement:"end",sx:{m:0}}),e(h,{direction:"row",justifyContent:"flex-end",children:e(Y,{variant:"contained",type:"submit",loading:n||f,children:r("profile.notification-card.save-button")})})]})})})})},ue=()=>{const{t:r}=_(),[a,{setLeft:n,setRight:u}]=B(!1),{enqueueSnackbar:c}=j(),[s,{isLoading:l}]=Z(),t=b.useCallback(async()=>{try{await s().unwrap(),c(r("notice::reset-security",{context:"success"}),{variant:"success"})}catch(o){console.error(o),c(r("notice::reset-security",{context:"failed"}),{variant:"error"})}finally{n()}},[s,c,r,n]);return d(F,{children:[e(g,{title:r("profile.reset-subscription-card.title"),children:d(h,{spacing:2,children:[e(N,{severity:"warning",children:r("profile.reset-subscription-card.alert")}),e(x,{variant:"contained",color:"error",fullWidth:!0,onClick:u,children:r("profile.reset-subscription-card.button")})]})}),d(O,{open:a,onClose:n,"aria-labelledby":"form-dialog-title",children:[e(R,{id:"form-dialog-title",children:r("profile.reset-subscription-card.dialog.title")}),e(G,{children:e(H,{children:r("profile.reset-subscription-card.dialog.content")})}),d(K,{children:[e(x,{onClick:n,color:"primary",children:r("profile.reset-subscription-card.dialog.cancel")}),e(Y,{onClick:t,color:"error",loading:l,children:r("profile.reset-subscription-card.dialog.confirm")})]})]})]})},P=2,fe=()=>{const{t:r}=_(),{data:a}=ee(),{data:n}=re(),{data:u}=ae(),c=b.useMemo(()=>Q,[r]),[s,l]=$("telegram_card_init",{defaultValue:0}),[t,{inc:o,dec:p}]=E(s,{min:0,max:P});b.useEffect(()=>{l(t)},[t]);const i=b.useMemo(()=>()=>d(h,{direction:"row",spacing:1,mt:2,children:[e(x,{onClick:()=>o(),variant:"contained",disabled:t>=P,children:r("profile.telegram-card.next_step")}),e(x,{onClick:()=>p(),variant:"text",disabled:t<=0,children:r("profile.telegram-card.previous_step")})]}),[r,t]);return e(g,{title:r("profile.telegram-card.title"),children:a!=null&&a.username||n!=null&&n.is_telegram?d(z,{activeStep:t,orientation:"vertical",children:[d(k,{children:[e(v,{children:e(m,{variant:"subtitle1",children:r("profile.telegram-card.add_bot",{context:"label"})})}),d(C,{children:[e(w,{children:e(c,{i18nKey:"profile.telegram-card.add_bot",tOptions:{context:"content",name:a==null?void 0:a.username},children:e(W,{href:`https://t.me/${a==null?void 0:a.username}`,target:"_blank"})})}),e(i,{})]})]}),d(k,{children:[e(v,{children:e(m,{variant:"subtitle1",children:r("profile.telegram-card.send_command",{context:"label"})})}),d(C,{children:[e(w,{children:e(c,{i18nKey:"profile.telegram-card.send_command",tOptions:{context:"content"},children:{command:`/bind ${u==null?void 0:u.subscribe_url}`}})}),e(i,{})]})]}),d(k,{children:[e(v,{children:e(m,{variant:"subtitle1",children:r("profile.telegram-card.add_to_group",{context:"label"})})}),d(C,{children:[e(w,{children:e(m,{children:e(c,{i18nKey:"profile.telegram-card.add_to_group",tOptions:{link:n==null?void 0:n.telegram_discuss_link,context:"content"},children:e(W,{href:n==null?void 0:n.telegram_discuss_link,target:"_blank",rel:"noreferrer"})})})}),e(i,{})]})]})]}):e(m,{children:r("profile.telegram-card.not_configured")})})},me=()=>{const{t:r}=_(),{data:a,isLoading:n}=M(),u=b.useMemo(()=>{var c,s,l,t;return[{key:r("profile.wallet-card.table.balance",{context:"key"}),value:r("profile.wallet-card.table.balance",{context:"value",value:(((c=a==null?void 0:a.balance)!=null?c:0)/100).toLocaleString("vi-VN",{style:"currency",currency:"VND"}),count:((s=a==null?void 0:a.balance)!=null?s:0)/100})},{key:r("profile.wallet-card.table.commission_balance",{context:"key"}),value:r("profile.wallet-card.table.commission_balance",{context:"value",value:(((l=a==null?void 0:a.commission_balance)!=null?l:0)/100).toLocaleString("vi-VN",{style:"currency",currency:"VND"}),count:((t=a==null?void 0:a.commission_balance)!=null?t:0)/100})}].map(o=>({key:e(m,{noWrap:!0,children:o.key}),value:e(m,{noWrap:!0,children:o.value})}))},[a,r]);return e(g,{title:r("profile.wallet-card.title"),children:e(q,{data:u,isValueLoading:n})})},be=()=>d(ce,{spacing:2,columns:{xs:1,md:2,xl:3},children:[e(se,{}),e(me,{}),e(de,{}),e(pe,{}),e(fe,{}),e(ue,{})]}),ke=()=>(ne("profile"),e(be,{}));export{ke as default};
